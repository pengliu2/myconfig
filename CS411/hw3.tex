\documentclass[letter,11pt]{article}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{ulem}
\usepackage{amsmath}
\pagestyle{fancy}
\rhead{pengliu2}
\lhead{Peng Liu}
\author{Peng Liu, I2CS student}
\title{Homework 3\\CS411 2011 Spring}

\begin{document}
\lstset{language=SQL}
\maketitle

\section*{Problem 1: Identifying BCNF} Solution:
\begin{enumerate}
\item[1.] No, it is not in BCNF. Because $S\rightarrow R$, but S is not a key.

\item[2.] No. $BD\rightarrow A$ but BD is not a key.

\item[3.] Yes. The closure for any FD is R. 

\end{enumerate}

\section*{Problem 2: BCNF Decomposition} Solution:

It's not in BCNF. Neither of the left sides in FDs $A\rightarrow BC$ and $D\rightarrow AF$ is a key.

To decompose it, we apply $A\rightarrow BC$ first and get
\begin{verbatim}
                R1(A,B,C)
                R2(A,D,E,F)
\end{verbatim}

R2 is not in BCNF because of $D\rightarrow AF$. So we decompose it with this FD. We get 
\begin{verbatim}
                R3(A,D,F)
                R4(D,E)
\end{verbatim}

Then the result is
\begin{verbatim}
                R1(A,B,C)
                R3(A,D,F)
                R4(D,E)
\end{verbatim}

\section*{Problem 3: SQL} Solution:
\begin{enumerate}
\item[1.]
\begin{verbatim}
SELECT Band_Name
FROM Band,Results
WHERE Band.Band_ID = Results.Band_ID
AND Results.Placement = '1st';
\end{verbatim}

\item[2.]
\begin{verbatim}
SELECT Band_Name
FROM Band,Festival,Schedule
WHERE Band.Band_ID = Schedule.Band_ID
AND Schedule.Fest_ID = Festival.Fest_ID
AND Festival.Festival_Name = 'Illini Marching Festival'
AND Schedule.Perf_Time > '16:00';
\end{verbatim}

\item[3.]
\begin{verbatim}
SELECT Director
FROM Band,Festival,Schedule
WHERE Band.Band_ID = Schedule.Band_ID
AND Festival.Fest_ID = Schedule_Fest_ID
AND Fest_Date > '31/10/2011';

\end{verbatim}

\item[4.]
\begin{verbatim}
SELECT Results.Placement
FROM Band,Results
WHERE Band.Band_ID = Results.Band_ID
AND Band.Colors LIKE '%Green%';

\end{verbatim}

\end{enumerate}

\section*{Problem 4: SQL Subqueries} Solution:
\begin{enumerate}
\item[1.]
\begin{verbatim}
SELECT Part_Num
FROM CenterChannel
WHERE mid_size > ALL(SELECT mid_size FROM TowerMains);

\end{verbatim}

\item[2.]
\begin{verbatim}
SELECT *
FROM Subwoofer
WHERE Peak_Output > ALL(SELECT Peak_Output
        FROM TowerMains
        WHERE Low_Size > 1);

\end{verbatim}

\item[3.]
\begin{verbatim}
SELECT Speaker.Sold_Indiv
FROM Speaker
WHERE Speaker.Part_Num = (SELECT Part_Num
        FROM TowerMains
        WHERE TowerMains.Low_Size > ALL(
                SELECT Low_Size
                FROM TowerMains)
        );

\end{verbatim}

\end{enumerate}

\end{document}


